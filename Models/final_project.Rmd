---
title: "final_project"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r packages, warning=FALSE, message=FALSE}
library(TSA, warn.conflicts = FALSE)
library(forecast)
library(Metrics)
library(ggplot2)
library(xts)
library(gdata)
library(zoo)
library(reshape2)
library(readxl)
library(tseries)
library(dplyr)
```
## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
df <- read.csv("Tetuan City power consumption.csv")
df
```


```{r}
date <- seq(from=as.POSIXct("2017-01-01 00:00", format = "%Y-%m-%d %H:%M"), length.out = nrow(df), by = "10 min") 

df <- xts(df[,7], date) 
train <- df['2017-01-01/2017-12-29']
test <- df['2017-12-30']
plot(df)
```



```{r}
kpss.test(train)
adf.test(train)
```
https://stats.stackexchange.com/questions/239360/contradictory-results-of-adf-and-kpss-unit-root-tests#:~:text=If%20you%20check%2C%20it%20is,the%20stationarity%20is%20trend%20stationarity.

Case 4 Reject unit root, reject stationarity: both hypotheses are component hypotheses â€“ heteroskedasticity in a series may make a big difference; if there is structural break it will affect inference.

```{r}
train1 <- diff(train)
train1 <- train1[seq(2, nrow(train1)),]
kpss.test(train1)
adf.test(train1)
```

```{r}
acf(train1)
pacf(train1)
eacf(train1)
```



```{r}
m0 <- auto.arima(train)
summary(m0)
```





```{r, warning=FALSE, message=FALSE}
preds_m3 <- forecast(m0, h=nrow(test))
pred_df <- data.frame(hours=index(test), test_val=test[,1], pred_val=preds_m3$mean)
d<- melt(pred_df, id.vars = "hours")

ggplot(d, aes(x=hours, y=value, color=variable)) + 
  geom_point(size=1) + 
  geom_line()
```


